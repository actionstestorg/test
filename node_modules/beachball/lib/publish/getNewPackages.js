"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getNewPackages = void 0;
const listPackageVersions_1 = require("../packageManager/listPackageVersions");
/**
 * Get package versions from the registry to determine if there are any new packages that didn't
 * have a change file. (This will only fetch packages *not* in `modifiedPackages`.)
 * @returns List of detected new packages
 */
async function getNewPackages(bumpInfo, options) {
    const { modifiedPackages, packageInfos } = bumpInfo;
    const maybeNewPackages = Object.keys(packageInfos).filter(pkg => !modifiedPackages.has(pkg) && !packageInfos[pkg].private);
    const publishedVersions = await (0, listPackageVersions_1.listPackageVersions)(maybeNewPackages, options);
    return maybeNewPackages.filter(pkg => {
        if (!publishedVersions[pkg]?.length) {
            console.log(`New package detected: ${pkg}`);
            return true;
        }
        return false;
    });
}
exports.getNewPackages = getNewPackages;
//# sourceMappingURL=getNewPackages.js.map