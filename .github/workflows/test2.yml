name: Update File and Push

on:
  workflow_dispatch:
    secrets:
        PAT:
            required: true
    branches:
      - test

jobs:
  update-file:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Update file content
      run: |
        echo "New content" > test.txt

    - name: Commit changes
      env:
          REPO_URL: github.com/iTwin/drawing-production

      run: |
          git config --global user.email "imodeljs-admin@users.noreply.github.com"
          git config --global user.name "imodeljs-admin"
          git add .
          git commit -m "Bump app version (automated)"
          git push "https://${{secrets.PAT_EXTENSION_SERVICE}}@${{ env.REPO_URL }}"