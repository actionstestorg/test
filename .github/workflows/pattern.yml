name: Filter Commits

on:
  workflow_dispatch:

jobs:
  filter-commits:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Filter commits
      run: |

        git fetch --unshallow
        git log --pretty=format:"%H %s" | grep -E "[0-9]+\.[0-9]+\.[0-9]+" > filtered_commits.txt
        echo "Filtered commits:"
        cat filtered_commits.txt

    - name: Checkout repository
      uses: actions/checkout@v2
      with:
          repository: actionstestorg/test2
          token: ${{ secrets.TOKEN_3 }}
    - name: Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '16'
    
    - name: Compare versions
      run: |
            package_version=$(jq -r '.version' package.json)
            echo "Package version: $package_version"
        
            git log --pretty=format:"%H %s" | grep -E "[0-9]+\.[0-9]+\.[0-9]+" > filtered_commits.txt
        
            
    

